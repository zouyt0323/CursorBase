# Camera App 专属检查清单

Android Camera App 式样中需要额外确认的领域特定项目。

## 1. Camera API 选型

| 项目 | CameraX (推荐) | Camera2 |
|------|----------------|---------|
| 复杂度 | 低（生命周期感知） | 高（手动管理） |
| 功能覆盖 | 95% 常见场景 | 100% 完全控制 |
| 最低 API | 21 | 21 |
| 厂商兼容性 | Google 已处理 | 需自行适配 |
| 推荐场景 | 常规拍照/录像 App | 专业相机/需要底层控制 |

**决策依据**：
- 需要手动控制 ISO/快门/对焦？→ Camera2
- 需要快速开发 + 广泛兼容？→ CameraX
- 混合方案：CameraX + Camera2 Interop Extensions

## 2. 拍摄模式清单

| 模式 | 优先级 | 技术要点 | 硬件要求 |
|------|:------:|---------|---------|
| 拍照 | P0 | ImageCapture, JPEG/HEIF | 后置摄像头 |
| 录像 | P0 | VideoCapture, H.264/H.265 | 后置 + 麦克风 |
| 前置自拍 | P0 | 镜像处理, 美颜 Pipeline | 前置摄像头 |
| HDR | P1 | HDR+ / Night Sight / CameraX HDR Extension | HDR 传感器 |
| 夜景模式 | P1 | 多帧合成, 长曝光 | — |
| 全景 | P1 | 图像拼接算法 | 陀螺仪 |
| 慢动作 | P2 | 120fps/240fps 录制 | 高帧率传感器 |
| 延时摄影 | P2 | 定时拍摄 + 合成视频 | — |
| 人像模式 | P2 | 深度传感器 / AI 背景虚化 | 双摄/ToF |
| 专业模式 | P2 | 手动 ISO/快门/WB/对焦 | Camera2 API |

## 3. 图像处理 Pipeline

```
场景检测(AI) → 预览流(CameraX Preview) → 用户拍摄
                                            ↓
                                    原始数据捕获
                                            ↓
                               ┌─── 滤镜/美颜处理(GPU) ───┐
                               │                          │
                               ▼                          ▼
                          实时预览效果              最终图片渲染
                                                        ↓
                                                   EXIF 写入
                                                        ↓
                                                   保存到存储
                                                        ↓
                                                  MediaStore 注册
                                                        ↓
                                                   缩略图生成
```

## 4. 权限清单

| 权限 | 用途 | 是否必须 | 运行时请求 |
|------|------|:--------:|:---------:|
| `CAMERA` | 摄像头访问 | 是 | 是 |
| `RECORD_AUDIO` | 录像时收音 | 是 | 是 |
| `READ_MEDIA_IMAGES` (API 33+) | 读取照片 | 是 | 是 |
| `READ_MEDIA_VIDEO` (API 33+) | 读取视频 | 是 | 是 |
| `READ_EXTERNAL_STORAGE` (API < 33) | 旧版存储访问 | 条件 | 是 |
| `WRITE_EXTERNAL_STORAGE` (API < 29) | 旧版写入 | 条件 | 是 |
| `ACCESS_FINE_LOCATION` | 照片地理标记 | 否 | 是 |
| `FOREGROUND_SERVICE` | 后台录像 | 条件 | 否 |

## 5. 文件存储策略

| 场景 | 存储位置 | API |
|------|---------|-----|
| 用户拍摄的照片/视频 | MediaStore (共享存储) | MediaStore API |
| 应用缓存（预览、缩略图） | App 内部缓存 | `cacheDir` |
| 滤镜/模板资源 | App 内部文件 | `filesDir` |
| 设置和偏好 | DataStore | Preferences DataStore |

## 6. 性能指标（Camera 专属）

| 指标 | 目标值 | 说明 |
|------|--------|------|
| 相机启动时间 | < 800ms | 从打开到预览可见 |
| 快门延迟 | < 200ms | 从按下到保存开始 |
| 拍照保存时间 | < 1s | 包含后处理 |
| 预览帧率 | >= 30fps | 稳定无卡顿 |
| 录像帧率 | 30/60fps 可选 | 根据分辨率调整 |
| 连拍速度 | >= 5fps | 连续拍照 |
| 内存峰值 | < 300MB | 包含图像缓冲 |

## 7. 式样确认检查清单

### 产品维度

- [ ] 目标用户画像已定义（至少 2 个）
- [ ] 核心用户旅程已描述（拍照、录像、查看）
- [ ] 竞品分析完成（至少 3 个竞品）
- [ ] MVP 功能范围已确定（P0 列表）
- [ ] 差异化特性已明确

### 功能维度

- [ ] 所有拍摄模式已列出并排优先级
- [ ] 每个功能有验收标准
- [ ] 异常处理场景已覆盖（权限拒绝、硬件不支持、存储满等）
- [ ] 权限请求策略已定义
- [ ] 文件存储方案已确定

### 设计维度

- [ ] 所有屏幕已列出
- [ ] 核心屏幕有布局描述
- [ ] 手势交互已定义
- [ ] 深色/浅色主题已规划
- [ ] 横屏/竖屏适配已说明
- [ ] 无障碍要求已列出

### 技术维度

- [ ] Camera API 选型已决定（CameraX / Camera2）
- [ ] 图像处理 Pipeline 已描述
- [ ] 架构分层已定义
- [ ] 模块划分已确定
- [ ] 第三方依赖已列出
- [ ] 性能指标已量化

### 质量维度

- [ ] 测试策略已定义
- [ ] 性能目标已量化
- [ ] 安全需求已列出
- [ ] 隐私合规已考虑
- [ ] 发布计划已制定
